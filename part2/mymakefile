#makefile
DESTDIR = /usr/local/bin
CC = gcc
WARN = -Wall
INCLUDE = -I../include
OPTIMIZE = -g
CFLAGS = $(WARN) $(INCLUDE) $(OPTIMIZE)
LDFLAGS = -lm -lpthread
BINS = droomd
OBJS = droomd.o kmodule.o signal.o dialog.o keepalive.o login.o logout.o md5.o misc.o passwd.o readconf.o watchport.o log.o ../utils/utils.o
SRCS = droomd.c kmodule.c signal.c dialog.c keepalive.c login.c logout.c md5.c misc.c passwd.c readconf.c watchport.c log.c ../utils/utils.c
INGS = log.h
.PHONY: all clean install
all: $(BINS)
clean:
	@echo " CLEAN droomd"
	@rm -f $(BINS) $(OBJS)
install: $(BINS)
	@echo " INSTALL droomd"
	@mkdir -p $(DESTDIR)
	@install -m 700 droomd $(DESTDIR)
droomd: $(OBJS)
	@echo " LD droomd"
	@$(CC) -o $@ $^ $(LDFLAGS)
$(OBJS): droomd.h log.h md5.h ../include/daemon_kernel.h ../include/client_daemon.h ../include/daemon_server.h ../include/utils.h
.c.o:
	@echo " CC $<"
	@$(CC) -c -o $@ $< $(CFLAGS)
